Modification of Algorithm 13.4 of "Reinforcement Learning: An Introduction, Second Edition".
