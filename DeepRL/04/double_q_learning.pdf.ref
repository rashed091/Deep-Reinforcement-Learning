Modification of Algorithm 6.7 of "Reinforcement Learning: An Introduction, Second Edition".
